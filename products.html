<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Orinoco, vente th√©matique en ligne !</title>
        <link href="css/style.css" rel="stylesheet">
        <script src="https://kit.fontawesome.com/0daa0b934d.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <header>
            <div>
            <!--LOGO ORINOCO-->
            <h1>ORINOCO</h1>
            </div>
            <nav>
                <ul>
                    <li>Acceuil Produits</li>
                    <li>Panier</li>
                </ul>
            </nav>
        </header>
        <section>
            <div id="product-template">
                <img id="image" src="">
                <div id="specification">
                    <h3 id="name"></h3>
                    <p id="price"></p>
                    <p id="description"></p>
                    <select id="personalisation" name="lentilles" required>--Please choose an option--</select>
                </div>
                <!-- <a href="" class = "add-to-basket"><i class="fas fa-plus"></i></a> -->
            </div>
        </section>
    <script>
        const imageDisplay = document.getElementById("image"); 
        const nameDisplay = document.getElementById("name");
        const priceDisplay = document.getElementById("price");
        const descriptionDisplay = document.getElementById("description");
        const personalisationDisplay = document.getElementById("personalisation");

        function getURL() {
            return window.location.href;
        }

        function getElement() {
            var url = new URL(getURL());
            var urlId = url.searchParams.get('id');
            return urlId;
        }

        var myId = getElement();
        console.log(myId);

        var request = new XMLHttpRequest();
        request.onload = function() {
            if (this.readyState == XMLHttpRequest.DONE && this.status == 200) {
                var camera = JSON.parse(this.responseText);
                console.log(camera);
                imageDisplay.src = camera.imageUrl;
                nameDisplay.innerHTML = camera.name;
                priceDisplay.innerHTML = camera.price;
                descriptionDisplay.innerHTML = camera.description;
                var cameraLenses = camera.lenses;
                cameraLenses.forEach((lense) => {
                    var option = document.createElement("option");
                    option.appendChild(document.createTextNode('New Option Text'));
                    personalisationDisplay.appendChild(option);
                    option.value = lense;
                    option.innerHTML = lense;
                    console.log(option);
                })
            }    
        };

        var myLocalHost = "http://localhost:3000/api/cameras/" + myId;
        request.open("GET", myLocalHost);
        request.send();

    </script>
    </body>
</html>